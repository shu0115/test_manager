<%= form_for( :testcase, url: { :action => params[:to_action] } ) do |f| %>
  <% if @testcase.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@testcase.errors.count, "error") %></h2>

      <ul>
      <% @testcase.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <%# 機能階層 %>
  <% 1.upto(@project.function_level){ |index| %>
  <div class="field">
    <%= f.label "function_level_#{index}", "#{t('testcase.function')}#{t('function.level')}#{index}" %>
    <select id="function_level_<%= index %>" name="function_level[<%= index %>]" style="width: 100px;">
      <option value="">-</option>
      <% @project.functions.each{ |func| %>
        <% if func.level == index %>
          <% if func.id.to_s == @function_level[index.to_s].to_s %>
            <option value="<%= func.id %>" selected="selected"><%= func.name %></option>
          <% else%>
            <option value="<%= func.id %>"><%= func.name %></option>
          <% end %>
        <% end %>
      <% } %>
    </select>
    <br />
  </div>
  <% } %>
  
  <div class="field">
    <%= f.label :title, t("testcase.title") %><br />
    <%= f.text_field :title, size: 50 %>
  </div>
  
  <div class="field">
    <%= f.label :page, t("testcase.page") %><br />
    <%= f.text_field :page, size: 50 %>
  </div>
  
  <div class="field">
    <%= f.label :operation, t("testcase.operation") %><br />
    <%= f.text_area :operation, rows: 10 %>
  </div>
  
  <div class="field">
    <%= f.label :result, t("testcase.result") %><br />
    <%= f.text_area :result, rows: 10 %>
  </div>

  <div class="field">
    <%= f.label :status, t("testcase.status") %><br />
    <%= f.text_field :status %>
  </div>

  <div class="field">
    <%= f.label :ticket_no, t("testcase.ticket_no") %><br />
    <%= f.text_field :ticket_no %>
  </div>

  <div class="field">
    <%= f.label :spec_flag, t("testcase.spec_flag") %><br />
    <%= f.text_field :spec_flag %>
  </div>
  
  <div class="field">
    <%= f.check_box( :operation_check, { checked: true }, "done" ) %>
    <%= f.label :operation_check, t("testcase.operation_check") %>
  </div>
  
  <div class="field">
    <%= f.label :note, t("testcase.note") %><br />
    <%= f.text_area :note, rows: 10 %>
  </div>

  <br />
  
  <div class="actions">
    <%= f.submit t("create") %>
  </div>
<% end %>